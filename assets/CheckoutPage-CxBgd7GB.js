import{c as y,j as e,P as C,u as v,a as E,b as P,r as S,d as I,M as O,D as _,L as k,F as A,O as c}from"./index-3RDIFUUU.js";import{u as M}from"./useOrder-HFJ1mVzI.js";import{O as R}from"./OrderSummary-Cw4NtyR7.js";import{A as T}from"./arrow-left-C6LBbUPJ.js";const D=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],L=y("shield-check",D),$=({selected:t,onChange:i,disabled:o=!1})=>e.jsx("div",{className:"space-y-3",children:Object.entries(C).map(([n,a])=>{const l=t===n;return e.jsxs("button",{type:"button",disabled:o,onClick:()=>i(n),className:`w-full flex items-center gap-4 px-4 py-3.5 rounded-xl border-2 text-left transition-all duration-150
              ${l?"border-[#009661] bg-emerald-50 shadow-sm":"border-slate-200 bg-white hover:border-slate-300 hover:bg-slate-50"}
              ${o?"opacity-50 cursor-not-allowed":"cursor-pointer"}
            `,children:[e.jsx("span",{className:"text-2xl w-8 text-center flex-shrink-0 select-none",children:a.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-semibold text-sm ${l?"text-[#009661]":"text-slate-800"}`,children:a.label}),a.popular&&e.jsx("span",{className:"text-[10px] font-bold px-1.5 py-0.5 rounded-full bg-[#009661] text-white tracking-wide",children:"POPULAR"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:a.description})]}),e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex-shrink-0 flex items-center justify-center transition-all
                ${l?"border-[#009661]":"border-slate-300"}`,children:l&&e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#009661]"})})]},n)})}),V=()=>{const t=v(),{user:i}=E(),{cart:o,itemCount:n,totalAmount:a,totalMrp:l,totalSavings:b}=P(),{createOrder:f,loading:m}=M(),[h,j]=S.useState(I.UPI),u=(a??0)>=A?0:_,p=(a??0)+u,r=i?.address,N=()=>new Promise((s,x)=>{if(window.Cashfree)return s(window.Cashfree);const d=document.createElement("script");d.src="https://sdk.cashfree.com/js/v3/cashfree.js",d.onload=()=>s(window.Cashfree),d.onerror=()=>x(new Error("Failed to load Cashfree SDK")),document.head.appendChild(d)}),g=async()=>{if(!r){t("/profile");return}const s=await f(h);if(!s.success)return;if(s.isCod){t(c.ORDER_SUCCESS,{state:{orderId:s.order.orderId,isCod:!0}});return}const{paymentSessionId:x,order:d}=s;try{(await N())({mode:"sandbox"}).checkout({paymentSessionId:x,redirectTarget:"_self",returnUrl:`${window.location.origin}${c.PAYMENT_PROCESSING}?order_id=${d.orderId}`}),t(c.PAYMENT_PROCESSING,{state:{orderId:d.orderId}})}catch{t(c.PAYMENT_PROCESSING,{state:{orderId:d.orderId}})}},w=o?.items?.map(s=>({_id:s._id,productSnapshot:{name:s.name,imageUrl:s.imageUrl},value:s.value,unit:s.unit,quantity:s.quantity,totalPrice:s.unitPrice*s.quantity}))??[];return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50 py-8 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 mb-6 font-medium text-sm transition-colors",children:[e.jsx(T,{className:"w-4 h-4"}),"Back to Cart"]}),e.jsx("h1",{className:"text-2xl font-black text-slate-900 mb-6",children:"Checkout"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-5",children:[e.jsxs("section",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-[#009661]"}),"Delivery Address"]}),e.jsx("button",{onClick:()=>t("/profile"),className:"text-xs font-semibold text-[#009661] hover:underline",children:r?"Change":"Add Address"})]}),r?e.jsxs("div",{className:"bg-emerald-50 border border-emerald-100 rounded-xl p-4",children:[e.jsxs("p",{className:"font-semibold text-slate-800 text-sm",children:[r.houseOrFlat,", ",r.street]}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:[r.area,", ",r.pincode]})]}):e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 text-amber-700 text-sm font-medium",children:"No delivery address found. Please add one before placing an order."})]}),e.jsxs("section",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsx("h2",{className:"font-bold text-slate-800 mb-4",children:"Payment Method"}),e.jsx($,{selected:h,onChange:j,disabled:m})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx(R,{items:w,itemsTotal:a??0,mrpTotal:l??0,savings:b??0,deliveryCharge:u,totalAmount:p}),e.jsx("button",{onClick:g,disabled:m||!r||n===0,className:`w-full py-4 bg-[#009661] text-white rounded-xl font-bold text-lg
                hover:bg-[#007d51] transition-all shadow-lg shadow-emerald-100
                active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed
                flex items-center justify-center gap-2`,children:m?e.jsx(k,{className:"w-5 h-5 animate-spin"}):`Pay â‚¹${p.toFixed(2)}`}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-slate-400 text-xs",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Secured by Cashfree Payments"})]})]})]})]})})};export{V as default};
