import{c as S,l as E,u as A,r as o,j as e,L as g,k as D,O as v,i as b,C as R,P as T,M as I,m as k,n as f}from"./index-BNceuH7k.js";import{u as P}from"./useOrder-B0WjA_uf.js";import{O as L}from"./OrderStatusBadge-D985_pAU.js";import{O as _}from"./OrderSummary-Dso3ZUFa.js";import{A as M}from"./arrow-left-BldCb6W1.js";import{C as $}from"./circle-x-D9ee8yQV.js";const U=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],F=S("credit-card",U),q=()=>{const{orderId:t}=E(),a=A(),{fetchOrder:r,cancelOrder:j,loading:l,error:d}=P(),[s,N]=o.useState(null),[w,x]=o.useState(!1),[i,m]=o.useState("");o.useEffect(()=>{t&&r(t).then(n=>{n&&N(n)})},[t,r]);const C=async()=>{if(!i.trim())return;const n=await j(s.orderId,i.trim());n.success&&(N(n.order),x(!1),m(""))};if(l&&!s)return e.jsx(p,{children:e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(g,{className:"w-8 h-8 animate-spin text-[#009661]"})})});if(!l&&!s)return e.jsx(p,{children:e.jsxs("div",{className:"bg-white rounded-2xl border border-red-100 p-10 text-center",children:[e.jsx(D,{className:"w-12 h-12 text-red-400 mx-auto mb-3"}),e.jsx("p",{className:"font-bold text-slate-700",children:"Order not found"}),d&&e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:d}),e.jsx("button",{onClick:()=>a(v.ORDERS),className:"mt-6 px-6 py-2.5 bg-[#009661] text-white rounded-xl font-semibold text-sm hover:bg-[#007d51] transition-all",children:"My Orders"})]})});const h=[b.CANCELLED,b.REFUNDED].includes(s.orderStatus),O=R.includes(s.orderStatus),u=T[s.payment?.method];return e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("button",{onClick:()=>a(v.ORDERS),className:"p-2 rounded-xl hover:bg-white/80 transition-colors",children:e.jsx(M,{className:"w-5 h-5 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-slate-900",children:"Order Details"}),e.jsxs("p",{className:"text-xs text-slate-500 font-mono",children:["#",s.orderId]})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(L,{status:s.orderStatus})})]}),!h&&e.jsx(z,{currentStatus:s.orderStatus}),h&&e.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-2xl p-4 flex gap-3 items-start",children:[e.jsx($,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-red-700 text-sm",children:["Order"," ",s.orderStatus===b.REFUNDED?"Refunded":"Cancelled"]}),s.cancellationReason&&e.jsx("p",{className:"text-red-500 text-xs mt-0.5",children:s.cancellationReason})]})]}),e.jsx(_,{items:s.items,itemsTotal:s.itemsTotal,mrpTotal:s.mrpTotal,savings:s.savings,deliveryCharge:s.deliveryCharge,totalAmount:s.totalAmount}),s.deliveryAddress&&e.jsxs("section",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2 mb-3",children:[e.jsx(I,{className:"w-4 h-4 text-[#009661]"}),"Delivery Address"]}),e.jsxs("p",{className:"text-sm text-slate-700",children:[s.deliveryAddress.houseOrFlat,", ",s.deliveryAddress.street]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-0.5",children:[s.deliveryAddress.area,", ",s.deliveryAddress.pincode]})]}),e.jsxs("section",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2 mb-3",children:[e.jsx(F,{className:"w-4 h-4 text-[#009661]"}),"Payment Info"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{label:"Method",value:u?`${u.icon}  ${u.label}`:s.payment?.method}),e.jsx(c,{label:"Status",value:k[s.payment?.status]||s.payment?.status}),s.payment?.transactionId&&e.jsx(c,{label:"Transaction ID",value:s.payment.transactionId,mono:!0}),s.payment?.paidAt&&e.jsx(c,{label:"Paid At",value:new Date(s.payment.paidAt).toLocaleString("en-IN")})]})]}),s.expectedDeliveryDate&&!h&&e.jsx("div",{className:"bg-emerald-50 border border-emerald-100 rounded-2xl px-5 py-4",children:e.jsxs("p",{className:"text-sm text-[#009661] font-semibold",children:["ðŸ• Expected Delivery:"," ",new Date(s.expectedDeliveryDate).toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long"})]})}),O&&e.jsx("button",{onClick:()=>x(!0),className:`w-full py-3 border-2 border-red-200 text-red-500 rounded-xl font-semibold text-sm
            hover:bg-red-50 transition-all`,children:"Cancel Order"}),w&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6 shadow-2xl",children:[e.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:"Cancel Order?"}),e.jsx("p",{className:"text-slate-500 text-sm mt-1 mb-4",children:"Please tell us why you're cancelling."}),e.jsx("textarea",{className:`w-full border border-slate-200 rounded-xl p-3 text-sm resize-none
                focus:outline-none focus:ring-2 focus:ring-[#009661] focus:border-transparent`,rows:3,placeholder:"Reason for cancellationâ€¦",value:i,onChange:n=>m(n.target.value)}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsx("button",{onClick:()=>{x(!1),m("")},className:"flex-1 py-3 rounded-xl bg-slate-100 text-slate-700 font-semibold text-sm hover:bg-slate-200 transition-all",children:"Keep It"}),e.jsxs("button",{disabled:!i.trim()||l,onClick:C,className:`flex-1 py-3 rounded-xl bg-red-500 text-white font-semibold text-sm
                  hover:bg-red-600 disabled:opacity-50 transition-all flex items-center justify-center gap-2`,children:[l&&e.jsx(g,{className:"w-4 h-4 animate-spin"}),"Cancel"]})]})]})})]})},y=["pending","confirmed","processing","out_for_delivery","delivered"],z=({currentStatus:t})=>{const a=y.indexOf(t);return e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsx("h3",{className:"font-bold text-slate-800 text-sm mb-4",children:"Order Progress"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-3.5 left-3.5 right-3.5 h-0.5 bg-slate-100"}),e.jsx("div",{className:"absolute top-3.5 left-3.5 h-0.5 bg-[#009661] transition-all duration-500",style:{width:a<=0?"0%":`${Math.min(a,f.length-1)/(f.length-1)*100}%`}}),e.jsx("div",{className:"relative flex justify-between",children:f.map((r,j)=>{const l=y.indexOf(r.status),d=a>=l,s=a===l;return e.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:`w-7 h-7 rounded-full border-2 flex items-center justify-center text-xs transition-all
                    ${d?"bg-[#009661] border-[#009661] text-white shadow-sm shadow-emerald-200":"bg-white border-slate-200 text-slate-400"}
                    ${s?"ring-4 ring-emerald-100":""}
                  `,children:r.icon}),e.jsx("span",{className:`text-[10px] font-semibold text-center max-w-[52px] leading-tight
                    ${d?"text-[#009661]":"text-slate-400"}`,children:r.label})]},r.status)})})]})]})},p=({children:t})=>e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50 py-8 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto space-y-4",children:t})}),c=({label:t,value:a,mono:r})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-500",children:t}),e.jsx("span",{className:`text-xs font-semibold text-slate-700 ${r?"font-mono":""}`,children:a})]});export{q as default};
